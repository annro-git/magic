console.log("<%= @operator %>");
console.log("<%= @card_id %>");
console.log("<%= @operator_in %>");

if ("<%= @operator_in %>" == "main_deck") {
  if ("<%= @operator %>" == "add") {
    // J INCREMENTE LA CARTE EN MAIN DECK
    occurence = parseInt($("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html());
    $("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html(occurence + 1);
  } else if ("<%= @operator %>" == "remove") {
    // je décremente la carte en maindeck, si son occurence est a 1, je la supprime du maindeck
    occurence = parseInt($("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html());
    if(occurence == 1) {
      $("ul.main-deck li[data-card-id=<%= @card_id %>]").remove();
    } else {
      $("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html(occurence - 1);
    }
  } else {
    // ICI, je dois déplacer une carte du side vers le main deck
    // plusieurs cas sont a gérer :
    // 1) si la carte existe deja en main deck, je l'inscrement
    // 2) si la carte n'existe pas j'ajoute le li dans le ul (je fais appel au partial)
    // puis, je décrement celle en side (ou je le supprime si elle est a 1 occurence)
    if($("ul.main-deck li[data-card-id=<%= @card_id %>]").length) {
      occurence = parseInt($("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html());
      $("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html(occurence + 1);
    } else {
      $("ul.main-deck").append("<%= escape_javascript render(:partial => 'card_in_maindeck', :locals => { card: Card.find(@card_id).decorate, deck: Deck.find(@deck_id) }) %>")
    }
    occurence = parseInt($("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html());
    if(occurence == 1) {
      $("ul.side-board li[data-card-id=<%= @card_id %>]").remove();
    } else {
      $("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html(occurence - 1);
    }
  }
} else {
  if ("<%= @operator %>" == "add") {
    // j'incremente la carte en sideboard
    occurence = parseInt($("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html());
    $("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html(occurence + 1);
   } else if ("<%= @operator %>" == "remove") {
    // je décremente la carte en sideboard, si son occurence est a 1, je la supprime du sideboard
    occurence = parseInt($("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html());
    if(occurence == 1) {
      $("ul.side-board li[data-card-id=<%= @card_id %>]").remove();
    } else {
      $("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html(occurence - 1);
    }
  } else {
    // ICI, je dois déplacer une carte du main deck vers le side board
    // plusieurs cas sont a gérer :
    // 1) si la carte existe deja en sideboard decks, je l'incremente
    // 2) si la carte n'existe pas j'ajoute le li dans le ul (je fais appel au partial)
    // puis, je décrement celle en maindeck (ou je le supprime si elle est a 1 occurence)
    if($("ul.side-board li[data-card-id=<%= @card_id %>]").length) {
      occurence = parseInt($("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html());
      $("ul.side-board li[data-card-id=<%= @card_id %>] .occurence").html(occurence + 1);
    } else {
      $("ul.side-board").append("<%= escape_javascript render(:partial => 'card_in_sideboard', :locals => { card: Card.find(@card_id).decorate, deck: Deck.find(@deck_id) }) %>")
    }
    occurence = parseInt($("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html());
    if(occurence == 1) {
      $("ul.main-deck li[data-card-id=<%= @card_id %>]").remove();
    } else {
      $("ul.main-deck li[data-card-id=<%= @card_id %>] .occurence").html(occurence - 1);
    }
  }
}
