= link_to '< retour', user_decks_path

%h1
  #{@deck.name}
  - if current_user.is_admin?
    %small= @deck.id
%p
  = "#{@deck.card_number} #{'carte'.pluralize(@deck.card_number)}"
  - if @deck.formats.any?
    , Format(s):
    = @deck.formats.collect(&:name).join(', ')
- if @deck.user_id == current_user&.id
  %p
    = link_to 'editer', edit_deck_path(slug: @deck.slug), class: 'btn btn-xs btn-warning'
    = link_to 'vue avancÃ©e', detail_deck_path(slug: @deck.slug), class: 'btn btn-xs btn-primary'
- elsif current_user&.id
  %p
    = link_to 'copier le deck', copy_public_deck_path(id: @deck.id), class: 'btn btn-xs btn-primary', method: :post

Main :
%ul.deck.cards-list.visual
  - sort_deck_cards(@main_cards).each do |label, cards|
    - cards.each_with_index do |card, index|
      %li
        %span= index == 0 ? "#{label} (#{cards.collect { |c| @deck.card_decks.where(card_id: c.id).first.occurences_in_main_deck }.sum})" : '&nbsp;'.html_safe
        = image_tag(card.visual, class: 'img-responsive')
        %span.card-link= link_to card.title(show_rarity: true), extension_set_card_path(slug: card.extension_set.slug, id: card.id)
        %span.occur-number= "x #{@deck.card_decks.where(card_id: card.id).first.occurences_in_main_deck}"
- if @sideboards.any?
  Sideboard :
  %ul.deck.cards-list.visual
    - @sideboards.decorate.each do |card|
      %li
        = image_tag(card.visual, class: 'img-responsive')
        %span.card-link= link_to card.title(show_rarity: true), extension_set_card_path(slug: card.extension_set.slug, id: card.id)
        %span.occur-number= @deck.card_decks.where(card_id: card.id).first.occurences_in_sideboard

.desc
  = @deck.description
